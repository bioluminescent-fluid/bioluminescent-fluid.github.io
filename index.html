<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bioluminescent Fluid Simulation</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,400;1,500;1,700&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="opening">

        <h1><span>Bio</span><span>lumi</span><span>nes</span><span>cence</span></h1>

    </div>

    <div class="below-the-fold">

        <section>
            <h3>Animation project</h2>
            <p class="vertical-paragraph">
                by 
                <span>Tiago</span>
                <span>Christine Wolf</span>
            </p>
        </section>

        <section>
            <h3>Simulation</h2>
            <div class="vertical-paragraph">
                <a href="./simulation"><img class="simulation-screenshot" src="./image-simulation.png" alt="A screenshot of the simulation, a bunch of blue dots against a dark background" srcset=""></a>
                <a href="./simulation"><p>Link</p></a>
            </div>
        </section>

        <article>
            <h2 class="gradient-text">
                Dev Blog
            </h2>

            <section>
                <h3>One: beginnings</h3>

                <div class="wrapper-prose">
                    <p>
                        This is the final project for the course <a href="https://www.kth.se/social/course/DH2323/">"Computer Graphics and Interaction"</a> by professor <a href="https://www.kth.se/profile/chpeters/">Cristopher Peters</a>, at <a href="https://www.kth.se/en">KTH Royal Institute of Technology</a>.
                    </p>
                    <p>
                        Originally, Tiago thought about doing his project about fluid simulation, and Christine, about simulating bioluminescent plankton. Then we realized it would make sense to combine efforts and build a fluid simulation and bioluminescent particles simulation on top of it!
                    </p>
                    <p>
                        We were inspired by Christineâ€™s previous project called <a href="https://christinelupus.com/portfolio/absorb-water-and-light-insanity/">ABSORB</a>, which was all about creating an immersive experience exhibition centered around water and light. It really sparked something in us and made us want to explore the idea of animating glowing water in a new and unique way.
                    </p>
                    <p>
                        After getting inspired, we started brainstorming ideas, and that's when we thought of it: bioluminescence! We thought it would be incredible to incorporate the natural phenomenon of bioluminescent organisms into the computer graphics project. We discussed the idea with the professor, who gave us some valuable advice. He suggested that using a particle system would be a relevant approach to achieve the desired effect. Additionally, we realized that we could take it up a notch by making the project touch-sensitive on a large screen, creating an interactive experience. This aspect excited us because we wanted to push the boundaries and engage the audience in a whole new way. Moreover, we decided to focus on the research aspect of the project to deepen our understanding and contribute to the existing knowledge.
                    </p>
                </div>

                <div class="container-pictures-1">
                    <img class="cont-1-right" src="./imgs/insp1.jpeg" alt="">
                    <img class="cont-1-bottom" src="./imgs/insp2.jpeg" alt="">
                    <img class="cont-1-top" src="./imgs/insp3.jpeg" alt="">
                    <img class="cont-1-left" src="./imgs/insp.gif" alt="">

                </div>

            </section>

            <section>
                <h3>Two: specification</h3>

                <div class="wrapper-prose">
                    <p>
                        To get started, we filled in the Specification Template provided by our professor. This helped us outline the key goals and requirements for the project. We wanted to ensure that we had a clear direction and a solid foundation to build upon. The template served as a great starting point and helped us organize our thoughts and ideas effectively. It was essential to lay the groundwork for the research and report.
                    </p>
                </div>

            </section>

            <section>
                <h3>Three: technical inspirations</h3>

                <div class="wrapper-prose">
                    <p>
                        With out specification, we could start getting our hands "dirty". We looked up for implementations of Fluid Simulation, and found many interesting resources. Some very inspirational, but without much explanation, and others very didactic, with detailed explanations.
                        
                        <h4>Inspirational (fluid simulation)</h4>

                        <ul>
                            <li>
                                This is probably the most amazing implementation of fluid simulation for the Web: <a href="https://paveldogreat.github.io/WebGL-Fluid-Simulation/">WebGL Fluid Simulation</a>
                            </li>

                            <li>
                                <a href="https://www.memo.tv/works/msafluid/">A C++ / Java / AS3 library, by Memo Akten, that is popular with artists</a>, used and adapted in many installations and performances. Memo says his main example was inspired by the unfinished game <a href="https://en.wikipedia.org/wiki/Plasma_Pong">Plasma Pong</a>, a version of Pong where the ball and paddles move through a fluid &mdash; which was frankly a super cool idea!
                            </li>
                        </ul>

                        <h4>Fluid simulation explained</h4>

                        <ul>
                            <li>
                                This chapter of Nvidia's "GPU Gems", <a href="https://developer.nvidia.com/gpugems/gpugems/part-vi-beyond-triangles/chapter-38-fast-fluid-dynamics-simulation-gpu">"Fast Fluid Dynamics Simulation on the GPU"</a>, by Mark J. Harris
                            </li>

                            <li>
                                Mike Ash's excellent <a href="https://mikeash.com/pyblog/fluid-simulation-for-dummies.html">"Fluid Simulation for dummies"</a>, with code samples in C.
                            </li>

                            <li>
                                <a href="https://www.mikeash.com/thesis/">Mike Ash's original master's thesis</a>, which inspired the writing of the previous item's tutorial (there are English and French versions of his thesis on the linked page)
                            </li>

                            <li>
                                Mike Ash actually based his implementation on Jos Stam's paper <a href="https://www.dgp.toronto.edu/public_user/stam/reality/Research/pdf/GDC03.pdf">"Real-Time FLuid Dynamics for Games" (pdf)</a>, the root of most fluid simulation implementations out there, apparently.
                            </li>

                            <li>
                                The always amazing Daniel Shiffman tackled a fluid simulation on his <a href="https://www.youtube.com/watch?v=alhpH6ECFvQ">"Coding Challenge #132: Fluid Simulation" (YouTube)</a>, where he adapts Mike's implementation to Processing.
                            </li>
                           
                        </ul>

                        <h4>The Navier-Stokes equations</h4>

                        <ul>

                            <li>
                                A very interesting <a href="https://www.youtube.com/watch?v=ERBVFcutl3M&t=152s">Numberphile episode on the Navier-Stokes Equations (YouTube)</a>, with <a href="https://tomrocksmaths.com/">Oxford's Tom Crawford</a>
                            </li>

                            <li>
                                Not specifically about Navier-Stokes equations, but more actually about some of the underlying Math (Vector Calculus): 3Blue1Brown's <a href="https://www.youtube.com/watch?v=rB83DpBJQsE&t=680s">"Divergence and curl: The language of Maxwell's equations, fluid flow, and more" (YouTube)</a>
                            </li>

                        </ul>

                        <h4>Particle Systems and Flow Fields</h4>

                        <ul>
                            <li>
                                Another Daniel Shiffman's video, <a href="https://www.youtube.com/watch?v=BjoM9oKOAKY&t=1391s">"Coding Challenge #24: Perlin Noise Flow Field" (YouTube)</a>
                            </li>

                            <li>
                                And yet another Daniel Shiffman's resource: Chapter 4 of his "The Nature of Code" book, <a href="https://natureofcode.com/book/chapter-4-particle-systems/">"Particle Systems"</a>
                            </li>
                        </ul>

                        <h4>
                            Inspirational (bioluminescence)
                        </h4>

                        <ul>
                            <li>
                                This mindblowing project by Studio Roosegaarde, <a href="https://www.studioroosegaarde.net/project/glowing-nature">"Glowing Nature"</a>
                            </li>

                        </ul>



                    </p>
                </div>

            </section>

            <section>
                <h3>Four: our strategy</h3>

                <div class="wrapper-prose">
                    <p>
                        Going through all these references, we decided to divide our implementation into the following steps:
                    </p>

                    <ul>
                        <li>
                            build a classic fluid dynamics simulation with the Navier-Stokes equations for incompressible flow, resulting in a fluid velocity grid
                        </li>
                        
                        <li>
                            use this velocity grid as a vector field to move a particle system built on top of the fluid simulation, representing the bioluminescent plankton
                        </li>
                        
                        <li>
                            make the simulation interactive by allowing touching/clicking to generate new particles, and dragging to change the velocity field realistically
                        </li>
                        
                        <li>
                            parameterize the particle system to simulate the bioluminescence behavior
                        </li>
                    </ul>
                </div>

            </section>

            <section>
                <h3>Five: the fluid simulation</h3>

                <div class="wrapper-prose">

                    <p>
                        We based our implementation on the ones by Mike Ash and Jos Stam. We begin by considering a two-dimensional discrete representation of the fluid in a square container. The container is represented by a squared homogeneous grid, with <em>N</em> cells on each side. For each grid cell, the idea is to compute and keep track of values for two variable: density (scalar) and velocity (vector), and we assume that these values are constant within a cell.
                    </p>

                    <figure>
                        <img src="./imgs/grid.jpg" alt="A hand drawn grid of cells, with velocity vectors plotted on it" srcset="">
                    </figure>

                    <p>
                        The Navier-Stokes equations provide a precise description of the evolution of a velocity field over time. Since a velocity field by itself is not something visually interesting, we can make the actual fluid "visible" by modeling its particles as a density field (scalar) that evolves through the velocity vector field.
                    </p>

                    <p>
                        This is important because we noticed that a common pattern in simulating fluids is computing some variable's value for a given cell by taking its previous value and applying some factor over the sum of the current values of its immediate neighbors, like so:
                    </p>

                    <figure>
                        <img src="./imgs/grid-2.jpg" alt="A hand drawn grid of cells, with velocity vectors plotted on it" srcset="">
                    </figure>

                    <p>
                        We wanted our simulation to be accessible from any device, so we chose to implement it using the Web Standards: HTML, CSS and (vanilla) Javascript. We used the HTML5 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API">Canvas API</a> for drawing. Our plan is to code everything from scratch, whenever possible, to maximize our learning!
                    </p>

                    <p>
                        So, we started creating basic classes and methods for representing things such as vectors and vector operations, and the moved on to the simulation itself. We tried to keep everything as parameterized as possible, so that we could tinker with the key aspects of the simulation.
                    </p>

                    <p>
                        To actually visualize the simulation, we mapped each cell to an actual square on the screen, mapping the cell's current density to the square's color's intensity. We started with a small grid (for fear of things blowing up), until we were sure that the simulation was behaving as expected. To test the simulation, we added interactivity right away: clicks for "spreading" density (that is, increasing the density's value on the clicked cell) and mouse drags for creating movement (by increasing the velocity vectors along and in the direction and intensity of the mouse's motion).
                    </p>

                    <p>
                        After many, many errors, and after figuring out why the errors were gone but nothing was apparently happening, we finally got the simulation working for a very small grid:
                    </p>

                    <figure>
                        <img src="./imgs/first-sim.png" alt="A hand drawn grid of cells, with velocity vectors plotted on it" srcset="">
                    </figure>

                    <P>
                        It doesn't look exciting now, but for us it was super exciting to see something work for the first time! Below, a video of this first prototype (with a slightly larger grid).
                    
                    </P>

                    <video controls autoplay="true" loop="true" width="100%">

                        <source src="./imgs/first-video.mp4"
                                type="video/mp4">
                    
                        Sorry, your browser doesn't support embedded videos.
                    </video>

                    <p>
                        We can see the effect of using larger and larger grids (meaning, smaller and smaller cell sizes: 20, 10 and 5px).
                    </p>

                </div>

                <div class="full-bleed-container">
                    <img src="./imgs/simulation-resolutions.png" alt="">
                </div>
                
                <div class="wrapper-prose">

                    <p>
                        The fluid simulation results in basically a varying velocity vector field, so we wanted to visualize that field. For that, we plotted the velocity vectors for each cell, and that is what we got:
                    </p>

                    <figure>
                        <img src="./imgs/vector-field.png" alt="A grid of cells, with velocity vectors plotted on it" srcset="">
                    </figure>


                </div>

            </section>






        </article>


    </div>


    
</body>
</html>